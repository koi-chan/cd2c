<div class="container main-container">
  <div class="row">
    <div class="col-xs-12 col-md-12 col-md-offset-2">
      <div class="main-panel">
        <div class="panel-body">
          <%= render('shared/flash') %>

          <h2>マイページ</h2>
          <p>ユーザー名: <%= @user.username %></p>
          <p>メールアドレス: <%= @user.email %></p>
          <p><%= link_to('ユーザー情報の編集', edit_user_registration_path, class: 'btn btn-success') %></p>

          <h3>連携しているチャット環境</h3>
          <table class="table table-striped table-responsive">
            <thead>
              <tr>
                <th>チャット環境</th>
                <th>サーバ</th>
                <th>アカウント</th>
                <th>連携日</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <% @user.chat_system_links.each do |link| %>
                <tr>
                  <td><%= link.chat_system.name %></td>
                  <td><%= link.server %></td>
                  <td><%= link.account %></td>
                  <td><%= link.created_at %></td>
                  <td><%= link_to('削除', '#', method: :delete, class: 'btn btn-danger') %></td>
                </tr>
              <% end %>
            </tbody>
          </table>

          <h3>有効な連携用トークン</h3>
          <table class="table table-striped table-responsive">
            <thead>
              <tr>
                <th>チャット環境</th>
                <th>トークン</th>
                <th>有効期限</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <% @user.chat_system_authentication_tokens.each do |token| %>
                <tr>
                  <td><%= token.chat_system.name %></td>
                  <td><input type="text" value="<%= token.token %>"></td>
                  <td><%= token.expire_at %></td>
                  <td><%= link_to('削除', chat_system_authentication_token_path(token), method: :delete, class: 'btn btn-danger') %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
          <%= link_to('連携用トークンを生成する', new_chat_system_authentication_token_path, class: 'btn btn-success') %>

          <h3>有効なメール認証用トークン</h3>
          <table class="table table-striped table-responsive">
            <thead>
              <tr>
                <th>チャット環境</th>
                <th>トークン</th>
                <th>有効期限</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <% @user.chat_system_authentication_mails.each do |token| %>
                <tr>
                  <td><%= token.chat_system.name %></td>
                  <td><input type="text" value="<%= token.token %>"></td>
                  <td><%= token.expire_at %></td>
                  <td><%= link_to('削除', chat_system_authentication_mail_path(token), method: :delete, class: 'btn btn-danger') %></td>
                </tr>
              <% end %>
            </tbody>
          </table>

          <%= render('shared/description_token') %>
        </div>
      </div>
    </div>
  </div>
</div>
